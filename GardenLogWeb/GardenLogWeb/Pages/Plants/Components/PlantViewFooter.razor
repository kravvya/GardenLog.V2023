@inject NavigationManager _navigationManager

@if (Plant != null && !string.IsNullOrWhiteSpace(Plant.PlantId))
{
    <ModalView OnCloseModal="CloseImageFormModal" @ref="ImageFormModal">
        <Body>
            <ImageForm OnClose=@CloseImageFormModal @ref=ImageForm />
        </Body>
    </ModalView>

    <div class="d-grid gap-2 d-md-flex justify-content-md-start">
        <button type="button" class="btn btn-primary" title="Edit Plant"  @onclick="@(() => OnEdit())"><span class="bi bi-pencil">&nbsp;</span></button>
        <button type="button" class="btn btn-secondary" title="Add Variety" @onclick="@(() => OnAddVariety())"><span class="bi bi-flower1">&nbsp;</span></button>
        <button type="button" class="btn btn-secondary" title="Add Growing Instruction" @onclick="@(() => OnAddGrowInstruction())"><span class="bi bi-card-checklist">&nbsp;</span></button>
        <button type="button" class="btn btn-warning" title="Add Image" @onclick="@(() => OnAddPlantImage())"><span class="bi bi-card-image">&nbsp;</span></button>
        <button type="button" class="btn btn-danger" title="Close" @onclick="@(() => Close())"><span class="bi bi-x-circle">&nbsp;</span></button>
    </div>

}
@code {
    [Parameter]
    public PlantModel Plant { get; set; }

    [Parameter]
    public Action Close { get; set; }

    private ModalView ImageFormModal { get; set; }
    private ImageForm ImageForm { get; set; }

     private async Task OnAddPlantImage()
    {
         ImageForm.Initialize(ImageEntityEnum.Plant, Plant.PlantId);
        await ImageFormModal?.OpenModal(Plant.Name, Plant.Color);
        StateHasChanged();
    }


    private void OnAddVariety()
    {
        _navigationManager.NavigateToCreatePlantVariety(Plant.PlantId);
    }


    private void OnAddGrowInstruction()
    {
        _navigationManager.NavigateToCreatePlantGrowInstruction(Plant.PlantId);
    }

    private void OnEdit()
    {
        _navigationManager.NavigateToEditPlant(Plant.PlantId);
    }

     private async Task CloseImageFormModal()
    {
        await ImageFormModal?.CloseModal();
        StateHasChanged();
    }


}
