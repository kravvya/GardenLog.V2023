@page "/viewplant/{PlantId}"

@inject IPlantService _plantService;
@inject NavigationManager _navigationManager;

@if (Plant != null)
{
    <Page Title="@Title" Description="@Description" BreadcrumbLinks="@breadcrubLinks">
        <PageContent>
            <PlantView Plant=@Plant />
            <PlantViewFooter Plant=@Plant Close=@ClosePage />
        </PageContent>
    </Page>
}

@code {
    [Parameter]
    public string PlantId { get; set; }

    private PlantModel Plant { get; set; }
    private string Title { get; set; }
    private string Description { get; set; }
    private List<BreadcrumbLink> breadcrubLinks = new();

    protected override async Task OnInitializedAsync()
    {
        breadcrubLinks.Add(new BreadcrumbLink("Plants", _navigationManager.GetPlantsUrl(), false));

        Plant = await _plantService.GetPlant(PlantId, true);

        if (Plant == null)
        {
            ClosePage();
        }

        breadcrubLinks.Add(new BreadcrumbLink(Plant.Name, _navigationManager.GetViewPlantUrl(Plant.PlantId), true));

        Title = $"{Plant.Name}";
        Description = $"{Plant.Name} Details";
    }
     

    protected void ClosePage()
    {
        _navigationManager.NavigateToPlants();

    }

}
